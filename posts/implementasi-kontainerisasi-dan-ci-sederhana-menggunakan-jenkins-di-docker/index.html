<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins" /><meta property="og:locale" content="en" /><meta name="description" content="Tech Stack" /><meta property="og:description" content="Tech Stack" /><link rel="canonical" href="https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/" /><meta property="og:url" content="https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/" /><meta property="og:site_name" content="xCodephile" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-21T07:26:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-23T00:35:56+07:00","datePublished":"2022-03-21T07:26:00+07:00","description":"Tech Stack","headline":"Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins","mainEntityOfPage":{"@type":"WebPage","@id":"https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/"},"url":"https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/"}</script><title>Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins | xCodephile</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="xCodephile"><meta name="application-name" content="xCodephile"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">xCodephile</a></div><div class="site-subtitle font-italic">All about tech-related</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/xcodephile" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['rifqitama16','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/rifqitama16">Rifqi Fauzan Pratama</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1647822360" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-21 </em> </span> <span> Updated <em class="timeago" data-ts="1647970556" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1299 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h1 id="tech-stack">Tech Stack</h1><p>Topik yang akan dibahas meliputi:</p><ul><li>Kontainer:<ul><li><a href="https://www.jenkins.io/doc/">Jenkins</a><li><a href="https://redis.io/">Redis</a></ul><li><a href="https://docs.docker.com/get-started/overview/">Docker</a><ul><li><a href="https://docs.docker.com/compose/">Docker Compose</a><li><a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a></ul><li><a href="https://www.jenkins.io/doc/">Jenkins</a>:<ul><li><a href="https://plugins.jenkins.io/job-dsl/">DSL</a><li><a href="https://www.jenkins.io/doc/">Job</a></ul><li><a href="https://smee.io/">Webhook</a></ul><h1 id="overview">Overview</h1><p><img data-src="../../assets/img/posts/jenkins-demo-dsl.gif" alt="Animasi demo singkat" data-proofer-ignore></p><p>Di posting kali ini kita akan men-setup Jenkins dan Redis di dua kontainer terpisah menggunakan <a href="https://docs.docker.com/get-started/overview/">Docker</a>, membuat Job Jenkins dengan jenis Freestyle Project yang berisi task sederhana untuk get dan set key Redis, memginstal plugin DSL dan membuat Seed Job sehingga semua Job lainnya dapat dibuat otomatis dengan hanya satu aksi tanpa harus klik sana klik sini (alias <a href="https://www.cloudbees.com/blog/configuration-as-code-everything-need-know">configuration as code</a>), serta mengunggah script DSL ke GitHub yang nantinya dihubungkan melalui webhook Smee agar dengan hanya mem-push ke GitHub, semua perubahan secara otomatis ter-apply ke Jenkins (alias <a href="https://www.infoworld.com/article/3271126/what-is-cicd-continuous-integration-and-continuous-delivery-explained.html">continuous integration</a>).</p><h1 id="faq">FAQ</h1><h2 id="kenapa-kontainer"><span class="mr-2">Kenapa Kontainer?</span><a href="#kenapa-kontainer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Jenkins dan Redis diinstal di kontainer agar tidak bergantung pada komputer host (laptop kamu). Apapun yang terjadi pada komputer host dan kontainer, akan mudah di-restore. Jika di kemudian hari Jenkins dan Redis tidak dibutuhkan lagi, cukup hapus kontainer dan image-nya saja (serta volume). Tidak bakal ada file sampah tersisa di komputer host.</p><h2 id="apa-itu-dsl"><span class="mr-2">Apa itu DSL?</span><a href="#apa-itu-dsl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://plugins.jenkins.io/job-dsl/">DSL</a> adalah plugin Jenkins yang memungkinkan kita menerapkan praktik <a href="https://www.cloudbees.com/blog/configuration-as-code-everything-need-know">configuration as code</a>. Ini adalah solusi bagus karena semua Job akan tersimpan dengan baik di repositori (misalnya di GitHub) karena tidak perlu lagi mengklik ini itu di dashboard Jenkins untuk membuat Job dan semua perubahan konfigurasi akan tercatat di GitHub. Konfigurasi tersimpan di hanya satu tempat. <a href="https://en.wikipedia.org/wiki/Single_source_of_truth">Single source of truth</a>. Selain itu, jika nantinya ada masalah pada Jenkins, semua konfigurasi dapat di-restore dengan cepat.</p><h1 id="prasyarat">Prasyarat</h1><ul><li>Docker sudah diinstal<li>Repositori GitHub sudah disiapkan</ul><h1 id="instalasi-dan-konfigurasi">Instalasi dan Konfigurasi</h1><h2 id="cp-1-setup-kontainer"><span class="mr-2">Cp. 1: Setup Kontainer</span><a href="#cp-1-setup-kontainer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Simpan file <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> dan <code class="language-plaintext highlighter-rouge">Dockerfile</code> berikut ini di dalam satu direktori yang sama.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1"># docker-compose.yml</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">jenkins</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span> 
      <span class="na">context</span><span class="pi">:</span> <span class="s">.</span>
      <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">jenkins</span>
    <span class="na">privileged</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s">root</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">8081:8080</span>
    <span class="pi">-</span> <span class="s">50001:50000</span>
    <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">~/docker-volume/jenkins:/var/jenkins_home</span>
    <span class="pi">-</span> <span class="s">/var/run/docker.sock:/var/run/docker.sock</span>
    <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">network</span>
  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">redis</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">redis</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">6379:6379</span>
    <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">network</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">redis-server --save 20 1 --requirepass 12345678 --loglevel warning</span>
<span class="na">networks</span><span class="pi">:</span>
  <span class="na">network</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>
</pre></table></code></div></div><div class="language-Dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c"># Dockerfile</span>
<span class="k">FROM</span><span class="s"> jenkins/jenkins:lts</span>

<span class="k">USER</span><span class="s"> root</span>

<span class="c"># install npm and Smee (webhook payload delivery service)</span>
<span class="k">RUN </span>curl <span class="nt">-fsSL</span> https://deb.nodesource.com/setup_17.x | bash -
<span class="k">RUN </span>apt update
<span class="k">RUN </span>apt <span class="nb">install</span> <span class="nt">-y</span> nodejs
<span class="k">RUN </span>npm <span class="nb">install</span> <span class="nt">--global</span> smee-client

<span class="c"># install screen to enable Smee run in background</span>
<span class="k">RUN </span>apt <span class="nb">install</span> <span class="nt">-y</span> screen

<span class="c"># install redis-cli command</span>
<span class="k">RUN </span>apt <span class="nb">install</span> <span class="nt">-y</span> redis-tools
</pre></table></code></div></div><p>Jalankan perintah berikut di dalam direktori di mana kedua file tersebut berada:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker-compose up <span class="nt">-d</span>
</pre></table></code></div></div><p>Validasi bahwa container telah berjalan dengan benar:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker ps

<span class="c"># output:</span>

CONTAINER ID   IMAGE             COMMAND                  CREATED        STATUS          PORTS                                              NAMES
b4bc27a05497   jenkins_jenkins   <span class="s2">"/sbin/tini -- /usr/…"</span>   11 hours ago   Up 45 minutes   0.0.0.0:8081-&gt;8080/tcp, 0.0.0.0:50001-&gt;50000/tcp   jenkins
6dc414e4d7aa   redis             <span class="s2">"docker-entrypoint.s…"</span>   11 hours ago   Up 45 minutes   0.0.0.0:6379-&gt;6379/tcp                             redis
</pre></table></code></div></div><h2 id="cp-2-setup-jenkins"><span class="mr-2">Cp. 2: Setup Jenkins</span><a href="#cp-2-setup-jenkins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="install-jenkins"><span class="mr-2">Install Jenkins</span><a href="#install-jenkins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Akses <a href="localhost:8081">localhost:8081</a> di browser. Halaman instalasi Jenkins akan muncul dan akan meminta temporary admin password. Jalankan perintah berikut untuk mengetahuinya:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker logs <span class="nt">-f</span> jenkins

<span class="c"># output</span>
Jenkins initial setup is required. An admin user has been created and a password generated.
Please use the following password to proceed to installation:

1906342b77f244c79ea6a24f28959b8e
</pre></table></code></div></div><p>Di halaman Customize Jenkins, pilih Install Suggested Plugins. Tunggu hingga semua plugin terinstal. Perhatikan bahwa menu Select Plugin to Install tidak akan menampilkan semua plugin yang tersedia di internet, termasuk DSL. Plugin DSL hanya bisa dperoleh di menu Plugin Manager ketika Jenkins telah selesai diinstal.</p><p><img data-src="../../assets/img/posts/jenkins-dashboard.png" alt="Dashboard Jenkins" data-proofer-ignore><em>Dashboard Jenkins</em></p><h3 id="install-plugin-dsl"><span class="mr-2">Install Plugin DSL</span><a href="#install-plugin-dsl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Jika proses instalasi Jenkins telah selesai, pada menu sidebar di halaman awal dashboard (gambar di atas), klik Manage Jenkins &gt; Manage Plugins &gt; Available &gt; cari <code class="language-plaintext highlighter-rouge">job dsl</code>. Centang dan klik Install Without Restart.</p><p><img data-src="../../assets/img/posts/jenkins-plugin-job-dsl.png" alt="Install plugin DSL" data-proofer-ignore></p><p>Terakhir, klik menu Manage Jenkins yang ada pada sidebar di halaman awal dashboard. Klik Configure Global Security, uncheck Enable script security for Job DSL scripts. Klik Save. Langkah ini diperlukan agar fitur keamanan Jenkins membolehkan Jenkins untuk mengeksekusi file DSL script (lihat langkah selanjutnya).</p><h3 id="buat-seed-job"><span class="mr-2">Buat Seed Job</span><a href="#buat-seed-job" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Seed Job adalah istilah yang mengacu pada Job khusus DSL yang fungsinya sebagai generator Job lain. Seed Job ini berjalan berdasarkan file DSL script yang nantinya kita sediakan.</p><p>Di sidebar halaman awal dashboard, klik New Item, ketik nama Seed Job, misalnya <code class="language-plaintext highlighter-rouge">Seed-Job-DSL</code>. Pilih Freestyle Project lalu klik OK. Tunggu hingga Seed Job selesai dibuat dan Jenkins akan mengarahkan kita ke halaman Configure.</p><p>Di bagian Build, klik menu dropdown Add Build Step lalu pilih Process Job DSLs. Masih di bagian Build, pilih Look on Filesystem dan ketik <code class="language-plaintext highlighter-rouge">job.groovy</code> di kolom isian DSL Script.</p><p><img data-src="../../assets/img/posts/jenkins-seedjob-configure-build.png" alt="" data-proofer-ignore><em>Build Section</em></p><p>Untuk integrasi ke repositori, masih di halaman Configure yang sama, centang GitHub hook trigger for GITScm polling di bagian Build Triggers. Kemudian, pilih Git di bagian Source Code Management. Di sini, cukup 2 kolom isian saja yang harus disesuaikan: Repository URL dan Branch Specifier. Repository URL diisi dengan nama repositori file <code class="language-plaintext highlighter-rouge">job.groovy</code> disimpan. Sedangkan Branch Specifier isi saja <code class="language-plaintext highlighter-rouge">main</code>.</p><p><img data-src="../../assets/img/posts/jenkins-seedjob-configure-buildtriggers.png" alt="" data-proofer-ignore><em>Build Triggers Section</em></p><p><img data-src="../../assets/img/posts/jenkins-seedjob-configure-scm.png" alt="" data-proofer-ignore><em>Source Code Management Section</em></p><p>Selesai. Jangan lupa klik Save.</p><h3 id="tambah-credential"><span class="mr-2">Tambah Credential</span><a href="#tambah-credential" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Langkah ini diperlukan untuk me-masking password Redis yang telah kita definisikan di file <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> pada baris ke 26. Password ini digunakan oleh Jenkins tiap kali mengakses Redis, baik untuk memperoleh atau mengeset suatu key. Alih-alih meng-hardcode password yang tentunya tidak aman, tambahkan password ini ke fitur Credentials Jenkins.</p><p>Caranya, klik username admin yang ada di header kanan atas (sebelah kiri tombol logout), lalu klik Credentials, klik Jenkins yang ada di bagian Stores from Parent, klik Global Credentials, lalu klik Add Credentials. Pada menu dropdown Kind, pilih Secret Text, lalu isi kolom isian Secret dengan password Redis, dalam hal ini <code class="language-plaintext highlighter-rouge">12345678</code>. Isi juga ID dengan nama kredensialnya, yaitu <code class="language-plaintext highlighter-rouge">REDIS_PASSWORD</code>. Klik OK.</p><p><img data-src="../../assets/img/posts/jenkins-cred.png" alt="" data-proofer-ignore></p><h2 id="cp-3-unggah-dsl-script-ke-repo"><span class="mr-2">Cp. 3: Unggah DSL Script ke Repo</span><a href="#cp-3-unggah-dsl-script-ke-repo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Buat file baru dengan nama <code class="language-plaintext highlighter-rouge">job.groovy</code>.</p><div class="language-groovy highlighter-rouge"><div class="code-header"> <span data-label-text="Groovy"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1">// job.groovy</span>
<span class="n">job</span><span class="o">(</span><span class="s1">'JOB-02-FREESTYLE-PROJECT-02-REDIS'</span><span class="o">){</span>
  <span class="n">description</span><span class="o">(</span><span class="s1">'Get or set Redis key.'</span><span class="o">)</span>

  <span class="n">parameters</span><span class="o">{</span>
    <span class="n">choiceParam</span><span class="o">(</span><span class="s1">'Action'</span><span class="o">,</span> <span class="o">[</span><span class="s1">'Getall'</span><span class="o">,</span> <span class="s1">'Get'</span><span class="o">,</span> <span class="s1">'Set'</span><span class="o">])</span>
    <span class="n">stringParam</span><span class="o">(</span><span class="s1">'Key'</span><span class="o">)</span>
    <span class="n">stringParam</span><span class="o">(</span><span class="s1">'Value'</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="n">wrappers</span> <span class="o">{</span>
    <span class="n">credentialsBinding</span> <span class="o">{</span>
      <span class="n">string</span><span class="o">(</span><span class="s1">'REDIS_PASSWORD'</span><span class="o">,</span> <span class="s1">'REDIS_PASSWORD'</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="n">steps</span> <span class="o">{</span>
    <span class="n">shell</span><span class="o">(</span><span class="s1">'''#!/bin/bash

if [[ "$Action" == "Getall" ]]; then
  redis-cli -h redis -p 6379 -a $REDIS_PASSWORD keys '*'
elif [[ "$Action" == "Get" ]]; then
  redis-cli -h redis -p 6379 -a $REDIS_PASSWORD get $Key
elif [[ "$Action" == "Set" ]]; then
  redis-cli -h redis -p 6379 -a $REDIS_PASSWORD set $Key $Value
fi
    '''</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Simpan file tersebut ke repositori.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>git add job.groovy
<span class="nv">$ </span>git commit <span class="nt">-m</span> <span class="s2">"create job.groovy"</span>
<span class="nv">$ </span>git push origin main
</pre></table></code></div></div><h2 id="cp-4-setup-webhook"><span class="mr-2">Cp. 4: Setup Webhook</span><a href="#cp-4-setup-webhook" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="buat-channel-baru-di-smee"><span class="mr-2">Buat Channel Baru di Smee</span><a href="#buat-channel-baru-di-smee" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Kunjungi <a href="https://smee.io/">smee.io</a> di browser. Klik Start a New Channel. Simpan baik-baik URL-nya. Kalau perlu di-bookmark.</p><h3 id="jalankan-smee-client"><span class="mr-2">Jalankan Smee Client</span><a href="#jalankan-smee-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Beralih ke kontainer Jenkins. Masuk ke kontainer dengan cara:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> jenkins bash
</pre></table></code></div></div><p>Jalankan perintah berikut untuk membuat session Screen baru, agar Smee client dapat berjalan secara background.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>screen <span class="nt">-S</span> smee
</pre></table></code></div></div><p>Jalankan Smee client.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span> smee <span class="nt">--url</span> https://smee.io/blablabla <span class="nt">--path</span> /github-webhook/ <span class="nt">--port</span> 8080
</pre></table></code></div></div><p>Deatach Screen dengan cara menekan tombol <kbd>ctrl</kbd> + <kbd>A</kbd> + <kbd>D</kbd>. Lalu keluar dari kontainer dengan menekan tombol <kbd>ctrl</kbd> + <kbd>D</kbd>.</p><h3 id="tambah-webhook-di-github"><span class="mr-2">Tambah Webhook di GitHub</span><a href="#tambah-webhook-di-github" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Di repositori GitHub tempat di mana file <code class="language-plaintext highlighter-rouge">job.groovy</code> disimpan, klik menu Settings, Webhooks, Add Webhook.</p><p>Isi Payload URL dengan URL Smee. Lalu pilih <code class="language-plaintext highlighter-rouge">application/json</code> di menu dropdown Content Type. Klik Add Webbhook.</p><p><img data-src="../../assets/img/posts/github-add-webhook.png" alt="" data-proofer-ignore></p><h2 id="cp-5-enjoy"><span class="mr-2">Cp. 5: Enjoy!</span><a href="#cp-5-enjoy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Yup, selesai.</p><p>Tiap kali kamu melakukan perubahan di repositori melalui perintah <code class="language-plaintext highlighter-rouge">git push</code> di komputermu, Jenkins akan secara otomatis menjalankan DSL script dan meng-apply perubahan tersebut. Katakanlah kamu membuat Job baru yang berisi task untuk menambah data ke database MySQL. Dengan hanya <code class="language-plaintext highlighter-rouge">git push</code>, Job tersebut langsung muncul di Jenkins dan siap pakai.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ci-cd/" class="post-tag no-text-decoration" >ci-cd</a> <a href="/tags/containerization/" class="post-tag no-text-decoration" >containerization</a> <a href="/tags/jenkins/" class="post-tag no-text-decoration" >jenkins</a> <a href="/tags/dsl/" class="post-tag no-text-decoration" >dsl</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/docker-compose/" class="post-tag no-text-decoration" >docker-compose</a> <a href="/tags/dockerfile/" class="post-tag no-text-decoration" >dockerfile</a> <a href="/tags/redis/" class="post-tag no-text-decoration" >redis</a> <a href="/tags/webhook/" class="post-tag no-text-decoration" >webhook</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins - xCodephile&amp;url=https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins - xCodephile&amp;u=https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/&amp;text=Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins - xCodephile" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/">Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana</a><li><a href="/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/">Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</a><li><a href="/posts/konsep-virtualisasi-kontainerisasi-docker-kubernetes/">Virtualisasi vs Kontainerisasi, Docker dan Kubernetes</a><li><a href="/posts/perintah-linux-di-windows/">WSL, Solusi Menjalankan Perintah Linux di Windows</a><li><a href="/posts/percanggih-vscode/">Bikin Visual Studio Code Jadi Lebih Minimalis dan Canggih [WIP]</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/containerization/">containerization</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/terminal/">terminal</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/wsl/">wsl</a> <a class="post-tag" href="/tags/docker-compose/">docker-compose</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/zsh/">zsh</a> <a class="post-tag" href="/tags/ci-cd/">ci-cd</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/"><div class="card-body"> <em class="timeago small" data-ts="1647959760" > 2022-03-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana</h3><div class="text-muted small"><p> Tech Stack Prometheus Grafana cAdvisor Docker Prasyarat Ini adalah lanjutan dari post sebelumnya, Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Je...</p></div></div></a></div><div class="card"> <a href="/posts/konsep-virtualisasi-kontainerisasi-docker-kubernetes/"><div class="card-body"> <em class="timeago small" data-ts="1646926200" > 2022-03-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Virtualisasi vs Kontainerisasi, Docker dan Kubernetes</h3><div class="text-muted small"><p> Sumber: incredibuild.com Ada dua istilah yang sering terucap oleh mereka yang menggeluti dunia cloud computing, yaitu virtualisasi dan kontainerisasi. Ada pula sebutan virtual machine, Docker, dan...</p></div></div></a></div><div class="card"> <a href="/posts/percanggih-vscode/"><div class="card-body"> <em class="timeago small" data-ts="1646147580" > 2022-03-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bikin Visual Studio Code Jadi Lebih Minimalis dan Canggih [WIP]</h3><div class="text-muted small"><p> “Posting ini masih ditandai sebagai WIP (work in progress).” Mirip seperti posting sebelumnya yang berjudul Percantik Tampilan Windows Terminal WSL Ubuntu Menggunakan Zsh, kali ini yang menjad...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/konsep-virtualisasi-kontainerisasi-docker-kubernetes/" class="btn btn-outline-primary" prompt="Older"><p>Virtualisasi vs Kontainerisasi, Docker dan Kubernetes</p></a> <a href="/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/" class="btn btn-outline-primary" prompt="Newer"><p>Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.linkedin.com/in/rifqitama16">Rifqi Fauzan Pratama</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/containerization/">containerization</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/terminal/">terminal</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/wsl/">wsl</a> <a class="post-tag" href="/tags/docker-compose/">docker-compose</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/zsh/">zsh</a> <a class="post-tag" href="/tags/ci-cd/">ci-cd</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
