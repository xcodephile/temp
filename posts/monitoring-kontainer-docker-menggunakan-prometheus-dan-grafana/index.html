<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana" /><meta property="og:locale" content="en" /><meta name="description" content="Tech Stack" /><meta property="og:description" content="Tech Stack" /><link rel="canonical" href="https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/" /><meta property="og:url" content="https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/" /><meta property="og:site_name" content="xCodephile" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-22T21:36:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-23T08:03:42+07:00","datePublished":"2022-03-22T21:36:00+07:00","description":"Tech Stack","headline":"Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana","mainEntityOfPage":{"@type":"WebPage","@id":"https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/"},"url":"https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/"}</script><title>Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana | xCodephile</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="xCodephile"><meta name="application-name" content="xCodephile"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">xCodephile</a></div><div class="site-subtitle font-italic">All about tech-related</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/xcodephile" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['rifqitama16','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/rifqitama16">Rifqi Fauzan Pratama</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1647959760" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-22 </em> </span> <span> Updated <em class="timeago" data-ts="1647997422" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="774 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h1 id="tech-stack">Tech Stack</h1><ul><li><a href="https://prometheus.io/docs/introduction/overview/">Prometheus</a><li><a href="https://grafana.com/docs/grafana/latest/introduction/">Grafana</a><li><a href="https://github.com/google/cadvisor">cAdvisor</a><li><a href="https://docs.docker.com/get-started/overview/">Docker</a></ul><p><img data-src="../../assets/img/posts/grafana-prometheus-monitoring.gif" alt="" data-proofer-ignore></p><h1 id="prasyarat">Prasyarat</h1><p>Ini adalah lanjutan dari post sebelumnya, <a href="https://xcodephile.github.io/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/">Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</a>. Agar lebih rapi, saya meletakkan Prometheus dan Grafana di satu jaringan Docker yang sama dengan kontainer yang dibuat di post sebelumnya, Jenkins dan Redis. Silahkan sesuaikan file <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> jika ingin dibuat berbeda jaringan.</p><blockquote class="prompt-tip"><div><p>Lihat detail jaringan yang dibuat oleh Docker dengan cara <code class="language-plaintext highlighter-rouge">docker network ls</code> dan <code class="language-plaintext highlighter-rouge">docker network inspect network_name</code></p></div></blockquote><h1 id="instalasi">Instalasi</h1><h2 id="cp-1-setup-kontainer"><span class="mr-2">Cp. 1: Setup Kontainer</span><a href="#cp-1-setup-kontainer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Simpan file <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> dan file config <code class="language-plaintext highlighter-rouge">prometheus.yml</code> berikut ini di dalam satu direktori yang sama.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="c1"># docker-compose.yml</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/prometheus:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">prometheus</span>
    <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">./prometheus.yml:/etc/prometheus/prometheus.yml</span>
    <span class="na">command</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">--config.file=/etc/prometheus/prometheus.yml'</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">--web.enable-lifecycle'</span>
    <span class="na">depends_on</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">cadvisor</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">9090:9090</span>
    <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">jenkins_network</span>
  <span class="na">cadvisor</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">gcr.io/cadvisor/cadvisor:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">cadvisor</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">8080:8080</span>
    <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">/:/rootfs:ro</span>
    <span class="pi">-</span> <span class="s">/var/run:/var/run:ro</span>
    <span class="pi">-</span> <span class="s">/sys:/sys:ro</span>
    <span class="pi">-</span> <span class="s">/var/lib/docker/:/var/lib/docker:ro</span>
    <span class="na">command</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">privileged=true</span>
    <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">jenkins_network</span>
  <span class="na">node-exporter</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/node-exporter:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">node-exporter</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">9100:9100</span>
    <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">jenkins_network</span>
  <span class="na">grafana</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">grafana/grafana:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">grafana</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000"</span>
    <span class="na">environment</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">GF_SECURITY_ADMIN_PASSWORD=admin</span>
    <span class="na">depends_on</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">prometheus</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">3000:3000</span>
    <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">jenkins_network</span>
<span class="na">networks</span><span class="pi">:</span>
  <span class="na">jenkins_network</span><span class="pi">:</span>
    <span class="na">external</span><span class="pi">:</span> <span class="no">true</span>
<span class="c1">## IMPORTANT:</span>
<span class="c1">## This project is designed to be on the same network as the Jenkins network: 'jenkins_network'.</span>
<span class="c1">## How to do that? Define name of jenkins network in every container (services.&lt;container_name&gt;.networks)</span>
<span class="c1">## and set networks.&lt;network_name&gt;.external to true.</span>
</pre></table></code></div></div><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1"># prometheus.yml</span>
<span class="na">global</span><span class="pi">:</span>
  <span class="na">scrape_interval</span><span class="pi">:</span> <span class="s">15s</span>
  <span class="na">external_labels</span><span class="pi">:</span>
    <span class="na">monitor</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Monitoring'</span>
<span class="na">scrape_configs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">prometheus'</span> 
    <span class="na">static_configs</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:9090'</span><span class="pi">]</span>
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">cAdvisor'</span> 
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">cadvisor:8080'</span><span class="pi">]</span>
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">node-exporter'</span> 
    <span class="na">static_configs</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">node-exporter:9100'</span><span class="pi">]</span>
</pre></table></code></div></div><p>Jalankan perintah berikut di dalam direktori di mana kedua file tersebut berada:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker-compose up <span class="nt">-d</span>
</pre></table></code></div></div><p>Validasi bahwa kontainer telah berjalan dengan benar:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker ps
</pre></table></code></div></div><h2 id="cp-2-validasi-cadvisor"><span class="mr-2">Cp. 2: Validasi cAdvisor</span><a href="#cp-2-validasi-cadvisor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>cAdvisor bertugas untuk mengumpulkan informasi mengenai semua kontainer yang sedang berjalan. Informasi ini nantinya diambil oleh Prometheus lalu diteruskan ke Grafana. Di Grafana inilah informasi disajikan dalam bentuk grafik.</p><p>Pastikan cAdvisor telah berjalan dengan baik dengan cara akses ke dashboard cAdvisor <a href="http://localhost:8080/docker">http://localhost:8080/docker</a> melalui browser. Lihat di bagian Subcontainers. Semua kontainer yang sedang berjalan ditampikan di sini.</p><p><img data-src="../../assets/img/posts/cadvisor-1.png" alt="" data-proofer-ignore></p><p>Jika daftar kontainer dapat ditampilkan oleh cAdvisor, silahkan skip ke bagian <a href="#setup-grafana">Setup Grafana</a>.</p><p>Namun jika tidak ada kontainer yang muncul sedangkan perintah <code class="language-plaintext highlighter-rouge">docker ps</code> menampilkan sebaliknya, dan jika kamu menggunakan WSL 2, maka besar kemungkinan cAdvisor salah dalam mencari ‘sumber’ kontainer. Ketahui errornya terlebih dahulu dengan cara:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ docker logs -f cadvisor
</pre></table></code></div></div><p>Jika ada banyak error yang bertuliskan <code class="language-plaintext highlighter-rouge">failed to identify the read-write layer ID for container ... open /rootfs/var/lib/docker ... no such file or directory</code>, maka jalankan perintah berikut ini.</p><blockquote class="prompt-danger"><div><p>Secara default root directory Docker berada di /var/lib/docker. Khusus untuk WSL, lokasinya berada di tempat yang berbeda. Saya belum bisa menjamin apakah lokasinya selalu di wsl\docker-desktop-data\version-pack-data\community\docker. Mohon dipastikan terlebih dahulu. Link terkait: github.com/google/cadvisor/issues/2648.</p></div></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ cd /mnt
$ sudo mkdir my-docker
$ sudo mount -t drvfs '\\wsl$\docker-desktop-data\version-pack-data\community\docker' /mnt/my-docker
</pre></table></code></div></div><p>Perintah di atas akan membuat direktori baru yang bernama <code class="language-plaintext highlighter-rouge">my-docker</code> lalu menyambungkan root directory Docker yang berada di luar Ubuntu ke direktori <code class="language-plaintext highlighter-rouge">/mnt/my-docker</code> yang berada di dalam Ubuntu.</p><p>Setelah menjalankan perintah di atas, ubah baris 27 di file <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> dari ini:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>- /var/lib/docker/:/var/lib/docker:ro
</pre></table></code></div></div><p>Menjadi ini:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>- /mnt/my-docker/:/rootfs/var/lib/docker:ro
</pre></table></code></div></div><p>Lalu silahkan build ulang dengan cara:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker-compose up <span class="nt">-d</span>
</pre></table></code></div></div><p>Validasi kembali melalui URL yang sama. Seharusnya cAdvisor sudah bisa memperoleh data kontainer.</p><h2 id="setup-grafana"><span class="mr-2">Setup Grafana</span><a href="#setup-grafana" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Akses dashboard Grafana di <a href="http://localhost:3000">http://localhost:3000</a>. Login dengan username <code class="language-plaintext highlighter-rouge">admin</code> dan password <code class="language-plaintext highlighter-rouge">admin</code>.</p><p><img data-src="../../assets/img/posts/grafana-ui-1.png" alt="" data-proofer-ignore></p><p>Agar Grafana terhubung ke Prometheus, kita harus menambahkan data source baru dengan cara klik Data Sources lalu pilih opsi Prometheus. Grafana akan mengarahkan kita ke halaman pengaturan. Di sini cukup isi form URL <code class="language-plaintext highlighter-rouge">http://prometheus:9090</code>. Gulir ke paling bawah halaman dan klik Save &amp; Test.</p><p><img data-src="../../assets/img/posts/grafana-ui-1b.png" alt="" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>Baik Grafana dan Prometheus sama-sama berada di satu jaringan Docker yang sama. Docker secara otomatis menghubungkan nama service (lihat baris 4 di <code class="language-plaintext highlighter-rouge">docker-compose.yml</code>) ke alamat IP-nya. Karena itulah, hanya dengan menuliskan <code class="language-plaintext highlighter-rouge">prometheus</code>, Grafana bisa langsung tersambung ke kontainer Prometheus.</p></div></blockquote><p>Langkah selanjutnya adalah merancang layout dashboard. Agar jauh lebih praktis, kita gunakan saja dashboard yang tersedia di internet. Caranya, silahkan navigasi ke menu Create lalu klik Import.</p><p><img data-src="../../assets/img/posts/grafana-ui-3.png" alt="" data-proofer-ignore></p><p>Di form Import via Grafana.com, isikan <code class="language-plaintext highlighter-rouge">893</code>. Ini adalah ID dari dashboard <a href="https://grafana.com/grafana/dashboards/893">grafana.com/grafana/dashboards/893</a>. Jangan lupa klik Load. Selanjutnya, isi nama dashboard di form Name kemudian pilih Prometheus pada menu dropdown Select a Prometheus Data Source. Klik Import.</p><p>Selesai.</p><p><img data-src="../../assets/img/posts/grafana.png" alt="" data-proofer-ignore></p><h1 id="tautan-eskternal">Tautan Eskternal</h1><ul><li><a href="https://prometheus.io/docs/guides/cadvisor/#monitoring-docker-container-metrics-using-cadvisor">prometheus.io/docs/guides/cadvisor/#monitoring-docker-container-metrics-using-cadvisor</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/containerization/" class="post-tag no-text-decoration" >containerization</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/docker-compose/" class="post-tag no-text-decoration" >docker-compose</a> <a href="/tags/monitoring/" class="post-tag no-text-decoration" >monitoring</a> <a href="/tags/prometheus/" class="post-tag no-text-decoration" >prometheus</a> <a href="/tags/grafana/" class="post-tag no-text-decoration" >grafana</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana - xCodephile&amp;url=https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana - xCodephile&amp;u=https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://xcodephile.github.io/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/&amp;text=Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana - xCodephile" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/monitoring-kontainer-docker-menggunakan-prometheus-dan-grafana/">Monitoring Kontainer Docker Menggunakan Prometheus dan Grafana</a><li><a href="/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/">Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</a><li><a href="/posts/konsep-virtualisasi-kontainerisasi-docker-kubernetes/">Virtualisasi vs Kontainerisasi, Docker dan Kubernetes</a><li><a href="/posts/perintah-linux-di-windows/">WSL, Solusi Menjalankan Perintah Linux di Windows</a><li><a href="/posts/percanggih-vscode/">Bikin Visual Studio Code Jadi Lebih Minimalis dan Canggih [WIP]</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/containerization/">containerization</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/terminal/">terminal</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/wsl/">wsl</a> <a class="post-tag" href="/tags/docker-compose/">docker-compose</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/zsh/">zsh</a> <a class="post-tag" href="/tags/ci-cd/">ci-cd</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/"><div class="card-body"> <em class="timeago small" data-ts="1647822360" > 2022-03-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</h3><div class="text-muted small"><p> Tech Stack Topik yang akan dibahas meliputi: Kontainer: Jenkins Redis Docker Docker Compose Dockerfile Jenkins: DSL Job ...</p></div></div></a></div><div class="card"> <a href="/posts/konsep-virtualisasi-kontainerisasi-docker-kubernetes/"><div class="card-body"> <em class="timeago small" data-ts="1646926200" > 2022-03-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Virtualisasi vs Kontainerisasi, Docker dan Kubernetes</h3><div class="text-muted small"><p> Sumber: incredibuild.com Ada dua istilah yang sering terucap oleh mereka yang menggeluti dunia cloud computing, yaitu virtualisasi dan kontainerisasi. Ada pula sebutan virtual machine, Docker, dan...</p></div></div></a></div><div class="card"> <a href="/posts/percanggih-vscode/"><div class="card-body"> <em class="timeago small" data-ts="1646147580" > 2022-03-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bikin Visual Studio Code Jadi Lebih Minimalis dan Canggih [WIP]</h3><div class="text-muted small"><p> “Posting ini masih ditandai sebagai WIP (work in progress).” Mirip seperti posting sebelumnya yang berjudul Percantik Tampilan Windows Terminal WSL Ubuntu Menggunakan Zsh, kali ini yang menjad...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/implementasi-kontainerisasi-dan-ci-sederhana-menggunakan-jenkins-di-docker/" class="btn btn-outline-primary" prompt="Older"><p>Implementasi Kontainerisasi dan CI (Continuous Integration) Sederhana Menggunakan Jenkins</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.linkedin.com/in/rifqitama16">Rifqi Fauzan Pratama</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/containerization/">containerization</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/terminal/">terminal</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/wsl/">wsl</a> <a class="post-tag" href="/tags/docker-compose/">docker-compose</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/zsh/">zsh</a> <a class="post-tag" href="/tags/ci-cd/">ci-cd</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
